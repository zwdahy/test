{=insert name="radio_globaljs" rid=$rid page_title=$page_title=}
<!--顶部通知 begin-->
<div class="notice-wrap">
    <div class="bg-wrap"></div>
    <div class="notice" id="notice">
        <div class="notice-in udv-clearfix">
        </div>
    </div>
</div>
<script type="text/javascript">
    requirejs(['lib'],function(){
        requirejs(['notice','$','_'],function(Notice){
            $(document).ready(function(){
                new Notice({
                    ctr: $("#notice")
                    //speed: 30 //px per second
                });
            });
        });
    });
</script>
<!--顶部通知 end-->
<div class="myRadio">
    <div class="wrap list-management" style="padding-top: 90px;">
        <!--顶部导航-->
        {=insert name="radio_head" page_name="myradio" is_login=$cuid=}
        <div class="udv-clearfix" style="margin-top: 30px;">
            <div class="infoCtr udv-clearfix">
                <div class="person-info">
                    <div class="avatar">
                        <a href="{=$curruserinfo.link_url=}" target="_blank">
                            <img src="{=$curruserinfo.avatar_large=}" height="65" width="65" alt="{=$curruserinfo.screen_name=}"/>
                        </a>
                    </div>
                    <div class="name"><a href="{=$curruserinfo.link_url=}" target="_blank">{=$curruserinfo.screen_name=}</a></div>
                </div>
                <div class="download">
                    <a href="app" target="_blank">
                        <img src="{=$smarty.const.RADIO_IMG_PATH=}download.jpg" alt="下载"/>
                    </a>
                </div>
            </div>
            <div id="list">
                <div class="type udv-clearfix">
                    <!--<span data-type="key" class="selected">管理我的预约（12）</span>-->
                    <span data-type="key" class="selected">管理我的收藏（{=$collection_num=}）</span>
                </div>
                <!--<ul class="reservation" data-type="value">-->
                    <!--<li class="udv-clearfix">-->
                        <!--<div class="p-left">-->
                            <!--<img src="http://dummyimage.com/33x33/999999/fff" height="33" width="33" alt="test">-->
                        <!--</div>-->
                        <!--<div class="p-middle">-->
                            <!--<p class="pm-program"><a href="url" target="_blank">《<em>xxx</em>节目》</a></p>-->
                            <!--<p class="pm-channel"><a href="url" target="_blank">xxx电台</a></p>-->
                        <!--</div>-->
                        <!--<div class="p-right">周一至周日 19:00-21:00</div>-->
                        <!--<div class="p-btn">-->
                            <!--<div style="float:right;">-->
                                <!--<a href="javascript:;">微博私信提醒</a><span class="line">|</span><a href="javascript:;">微电台客户端提醒</a> <a class="cancel" href="javascript:;">取消预约</a>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</li>-->
                <!--</ul>-->
                <ul class="collection" data-type="value">
					{=if $collection=}
					{=foreach from=$collection item=myitem name=name=}
                    <li  {=if $smarty.foreach.myname.iteration ==1=}class="udv-clearfix item-first"{=elseif $smarty.foreach.myname.iteration <=3=}class="udv-clearfix" {=else=} class="udv-clearfix" {=/if=}>
                        <div class="p-left">
                            <a href="{=$myitem.radio_url=}">
                                <img src="{=$myitem.img_path=}" height="33" width="33" alt="{=$myitem.name=}">
                            </a>
                            <a href="javascript:;" class="play" ></a>
                        </div>
                        <div class="p-middle"><a href="{=$myitem.radio_url=}" target="_blank">{=$myitem.name=}</a></div>
                        <div class="p-right">
                            <a class="cancel" href="javascript:;" data-action="cancelCollection" data-rid="{=$myitem.rid=}">取消收藏</a>
                        </div>
                    </li>
					{=/foreach=}
					{=/if=}
                </ul>
				<div id="recommendList"></div>
            </div>
            <script type="text/javascript">
                requirejs(['lib'],function(){
                    requirejs(['util/switch','$'],function(Switch){
                        $(document).ready(function(){
                            new Switch({
                                triggerEvent: 'click',
                                selectedCls: 'selected',
                                ctr: $("#list")
                            });
                        });
                    });
                });
            </script>
        </div>
    </div>
</div>
<div class="wrap list-management">
    <!--返回顶部 begin-->
    <div class="side-btns" id="side-btns" style="visibility: hidden;bottom: 80px;">
        <a class="back" href="javascript:;"></a>
    </div>
    <script type="text/javascript">
        requirejs(['lib'],function(){
            requirejs(['component/backToTop'],function(){
                $(document).ready(function(){

                });
            });
        });
    </script>
    <!--返回顶部 end-->
</div>
<script type="text/javascript">
    //页面加关注功能
    requirejs(['lib'],function(){
        requirejs(['util/network','util/login','$'],function(network,login){
            var $body=$("body");
            $(document).ready(function(){
                $body.on('click', '[data-action="follow"]',function(e){
                    var $cTarget=$(e.currentTarget);
                    if(!scope.islogin){
                        login.showAtCenter();
                    }
                    network.follow({
                        uid: $cTarget.attr('data-uid')
                    }, function(d){
						if(d.code=='A00006')
                            $cTarget.replaceWith($('<a class="icon-followed" href="javascript:;"><em></em>已关注</a>'));
					})
                })
            });
        });
    });
</script>
<script type="text/javascript">
    //页面取消收藏功能
    requirejs(['lib'],function(){
        requirejs(['util/network','util/login','$'],function(network,login){
            var $body=$("body");
            $(document).ready(function(){
                $body.on('click', '[data-action="cancelCollection"]',function(e){
                    var $cTarget=$(e.currentTarget);
                    if(!scope.islogin){
                        login.showAtCenter();
                    }
                    if(!scope.islogin){
                        login.showAtCenter();
                    }
                    network.cancelRadioCollection({
                        rid: $cTarget.attr('data-rid')
                    }, function(d){
                         if(d.code=='A00006')
                            $($cTarget.parents('li')[0]).remove();
                            var collectStr=$('#list .type .selected').html();
                            var collectNum=collectStr.match(/\d+/g)[0]-1;
                            $('#list .type .selected').html(collectStr.replace(/\d+/g,collectNum));
                    });

                })
            });
        });
    });
</script>
{=insert name="radio_footer"=}
<script type="text/javascript">
    requirejs(['lib'],function(){
        requirejs(['myradio/myradio'],function(){});
    });
</script>
</body>
</html>